<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>마이킹</title>
<link href="css/mypage.css" rel="stylesheet" type="text/css" />
<link rel="icon" href="../img/favicon.ico">
<script
   src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.12.4.min.js"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<link rel="stylesheet"
   href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

<!-- jQuery library -->
<script
   src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script
   src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript">
   var pay = '[[${totalPay}]]';

   var amount = (pay % 30000) / 30000 * 100;
   var restPay = 30000 - (pay % 30000);

	$(document).ready(function() {
		if (pay <= 60000) {
			$('.progress-bar').css('width', amount + '%');
			$('#rest').text("등급 상승까지 "+restPay + '원 남았습니다!');
		} else {
			$('.progress-bar').css('width', '100%');
			$('#rest').text('당신은 이미 최고 등급입니다.');
		}

		if (pay >= 0 && pay < 30000) {
			document.getElementById("img_box").src = '../img/mark01.png';
			document.getElementById("img_name").innerText = "TW 등급";
		} else if (pay >= 30000 && pay < 60000) {
			document.getElementById("img_box").src = '../img/mark02.png';
			document.getElementById("img_name").innerText = "WJ 등급";
		} else {
			document.getElementById("img_box").src = '../img/mark03.png';
			document.getElementById("img_name").innerText = "SM 등급";
		}
	})
	
   window.onload = function() {
      const item = Math.floor(Math.random() * 15) + 40;
      $("#order_t").text(item);
   }
</script>
</head>
<body>
   <header th:include="/header"></header>
   <div class="contentsWrap">
      <div class="web_container">
         <div class="subtitWrap">
            <h2 class="page_tit">My킹</h2>
            <div class="progress">
               <div class="progress-bar" role="progressbar" aria-valuenow="70"
                  aria-valuemin="0" aria-valuemax="100">
                  <span><strong id="rest"></strong>
                  </span>
               </div>
            </div>
         </div>

         <div class="myking_info">
            <div class="member_name">
               <p>
                  <strong th:text="${info.name}"></strong><span>님! 반갑습니다</span>
               </p>
            </div>
            <div class="member_info">
               <!-- 등급이미지 -->
               <div class="member_ship">
                  <ul>
                     <!-- 멤버등급 -->
                     <li class="membership_mark"><img id="img_box"></li>
                     <li class="membership_grade" id="img_name"></li>
                  </ul>
               </div>
            </div>
            <div class="member_info">
               <!-- 등급이미지 -->
               <div class="info_change">
                  <ul>
                     <li class="membership_tit2"><a href="mypageUpdateForm">정보변경</a></li>
                  </ul>
               </div>
            </div>
            <div class="member_info">
               <!-- 등급이미지 -->
               <div class="order_history">
                  <ul>
                     <li class="membership_tit2"><a href="orderHistoryForm">주문이력</a></li>
                  </ul>
               </div>
            </div>
         </div>
      </div>
   </div>




   <div class="contentBox">
      <div class="contentsWrap2">
         <div class="web_container2">
            <div class="container_tit">
               <div class="tit01">
                  <img src="/img/orderlist.png"> <span>최근 주문내역</span>
               </div>
            </div>
            <!-- 주문내역이 없을시 노출 -->
            <div class="nodata" style="display: none;">
               <p>주문 목록이 없습니다.</p>
            </div>
            
            <div class="container01"th:each="orderInfo,i:${orderInfo}">
               <div class="titbox">
                  <!-- 주문내역 상단(이름) -->
                  <p th:text="${productName[i.index]}+ ' 외 '+${productCount[i.index]}+'건'">텍사스 칠리와퍼 외 3건</p>
               </div>
               <div class="cont">
                  <div class="info">
                     <ul>
                        <li>주문번호</li>
                        <!-- 주문번호 백데이터 입력 -->
                        <li th:text="${orderInfo.orderNum}">923209055</li>
                     </ul>
                     <ul>
                        <li>주문시간</li>
                        <!-- order 백데이터 입력 -->
                        <li th:text="${orderInfo.orderTime}">2022.08.17 PM 13:25</li>
                     </ul>
                     <ul class="time">
                        <li>배달 예상시간</li>
                        <!-- 주문시간 + 30분 +-10분 랜덤 0~10 입력 -->
                        <li><span id="order_t"></span><span>~60분</span></li>
                     </ul>
                  </div>
               </div>
            </div>

         </div>
      </div>
   </div>
   <footer th:include="/footer"></footer>

</body>
</html>